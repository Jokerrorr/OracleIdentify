本部分为训练过程以及最终常用的一些函数